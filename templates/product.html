{{ template "base" . }} {{ define "content" }}
<div
  class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden max-w-5xl mx-auto"
>
  <div class="flex flex-col md:flex-row">
    <div class="md:w-1/2 bg-gray-100 relative min-h-[400px] {{ if eq .Data.Product.Stock 0 }}opacity-75{{ end }}">
      {{if .Data.Product.ImageURL}}
      <img
        src="{{.Data.Product.ImageURL}}"
        alt="{{.Data.Product.Name}}"
        class="absolute inset-0 w-full h-full object-cover {{ if eq .Data.Product.Stock 0 }}grayscale{{ end }}"
      />
      {{ if eq .Data.Product.Stock 0 }}
      <div class="absolute inset-0 bg-black/30 flex items-center justify-center">
        <div class="text-center">
          <span class="bg-red-600 text-white font-bold px-6 py-3 rounded-lg text-lg">Fora de Estoque</span>
        </div>
      </div>
      {{ end }}
      {{else}}
      <div
        class="absolute inset-0 flex items-center justify-center text-gray-400"
      >
        Sem imagem
      </div>
      {{end}}
    </div>

    <div class="md:w-1/2 p-8 flex flex-col justify-center">
      <div class="mb-auto">
        <a
          href="/"
          class="inline-block bg-gray-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition mb-4"
          >Voltar para Loja</a
        >
        <h1 class="text-3xl font-black text-gray-900 mb-4">
          {{.Data.Product.Name}}
        </h1>
        <p class="text-gray-600 leading-relaxed mb-6">
          {{.Data.Product.Description}}
        </p>
      </div>

      <div class="pt-6 border-t border-gray-100">
        <div class="flex items-center justify-between mb-6">
          <span class="text-gray-500 text-sm">Preço total</span>
          <span class="text-4xl font-bold text-blue-700"
            >{{.Data.Product.FormattedPrice}}</span
          >
        </div>

        {{ if eq .Data.Product.Stock 0 }}
        <div
          class="bg-red-50 border border-red-200 text-red-800 p-4 rounded-lg text-center font-medium"
        >
          Este produto está fora de estoque no momento
        </div>
        {{ else }}
        <form action="/add-to-cart" method="GET" class="space-y-4">
          <input type="hidden" name="id" value="{{.Data.Product.ID.Hex}}" />

          <div class="flex gap-4">
            <div class="w-1/3">
              <label
                class="block text-xs font-bold text-gray-500 uppercase mb-1"
                >Qtd</label
              >
              <input
                type="number"
                name="quantity"
                value="1"
                min="1"
                class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500"
              />
            </div>
            {{if .Data.Product.Sizes}}
            <div class="w-2/3">
              <label
                class="block text-xs font-bold text-gray-500 uppercase mb-1"
                >Tamanho</label
              >
              <select
                name="size"
                class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:border-blue-500"
              >
                {{range .Data.Product.Sizes}}
                <option value="{{.}}">{{.}}</option>
                {{end}}
              </select>
            </div>
            {{end}}
          </div>

          {{ if .IsAdmin }}
          <div
            class="bg-yellow-50 border border-yellow-200 text-yellow-800 p-4 rounded-lg text-center font-medium"
          >
            Modo Admin: Visualização apenas
          </div>
          {{ else }} {{ if .IsLoggedIn }}
          <button
            type="submit"
            class="block w-full bg-blue-600 hover:bg-blue-700 text-white text-center font-bold text-lg py-4 rounded-xl transition shadow-lg"
          >
            Adicionar ao Carrinho
          </button>
          {{ else }}
          <button
            type="submit"
            class="block w-full bg-gray-800 hover:bg-gray-900 text-white text-center font-bold text-lg py-4 rounded-xl transition"
          >
            Comprar
          </button>
          {{ end }} {{ end }}
        </form>
        {{ end }}
      </div>
    </div>
  </div>
</div>
{{ end }}
